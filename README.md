# Jetchat - æ™ºèƒ½AIå¯¹è¯åº”ç”¨

<div align="center">
  <img src="screenshots/jetchatlogo.png" alt="Jetchat Logo" width="200"/>
  
  <h3>ğŸ™ï¸ å³æ¢¦ AI - æ™ºèƒ½å¤šæ¨¡æ€å¯¹è¯åº”ç”¨</h3>
  <p>æ”¯æŒæ–‡æœ¬å¯¹è¯ã€å›¾ç‰‡è¯†åˆ«ä¸ç”Ÿæˆã€<strong>è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¯¹è¯</strong></p>
  
  [![Kotlin](https://img.shields.io/badge/Kotlin-1.9.0-blue.svg)](https://kotlinlang.org)
  [![Compose](https://img.shields.io/badge/Compose-1.5.4-green.svg)](https://developer.android.com/jetpack/compose)
  [![Android](https://img.shields.io/badge/Android-7.0+-brightgreen.svg)](https://www.android.com)
  [![License](https://img.shields.io/badge/License-Apache%202.0-orange.svg)](LICENSE)
  
  <p>
    <a href="#-é¡¹ç›®ç®€ä»‹">é¡¹ç›®ç®€ä»‹</a> â€¢
    <a href="#-å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> â€¢
    <a href="#-æ ¸å¿ƒåŠŸèƒ½è¯¦è§£">åŠŸèƒ½è¯¦è§£</a> â€¢
    <a href="#-æœ€æ–°æ›´æ–°">æœ€æ–°æ›´æ–°</a>
  </p>
  
  <img src="https://img.shields.io/badge/ğŸ†•-è±†åŒ…å®æ—¶å¯¹è¯-ff69b4?style=for-the-badge" alt="New Feature"/>
</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

Jetchatæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ™ºèƒ½å¯¹è¯åº”ç”¨ï¼Œå±•ç¤ºäº†ç°ä»£Androidå¼€å‘çš„æœ€ä½³å®è·µã€‚é¡¹ç›®é‡‡ç”¨**Jetpack Compose**æ„å»ºUIï¼Œé›†æˆäº†**å¤šæ¨¡æ€AIèƒ½åŠ›**ï¼ˆæ–‡æœ¬å¯¹è¯ã€å›¾ç‰‡è¯†åˆ«ã€å›¾ç‰‡ç”Ÿæˆï¼‰ï¼Œå¹¶å®ç°äº†**æ™ºèƒ½å¯¹è¯æ‘˜è¦ç³»ç»Ÿ**ï¼Œèƒ½å¤Ÿæ”¯æŒæ— é™è½®å¯¹è¯è€Œä¸å—Tokené™åˆ¶ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **å¤šæ¨¡æ€AIäº¤äº’**
  - æ–‡æœ¬å¯¹è¯ï¼ˆGemini 2.5 Proï¼‰
  - å›¾ç‰‡è¯†åˆ«ä¸ç†è§£
  - å›¾ç‰‡ç”Ÿæˆï¼ˆDoubao SeedDream + AI Promptä¼˜åŒ–ï¼‰
  - **ğŸ“ æ–‡æ¡£ä¸Šä¼ ä¸åˆ†æ**ï¼ˆv1.6.0ï¼‰
  - **ğŸ™ï¸ ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¯¹è¯**ï¼ˆv1.8.0ï¼‰
    - Whisper è¯­éŸ³è¯†åˆ«
    - TTS è¯­éŸ³åˆæˆ
    - è¯­éŸ³æ’­æ”¾ä¸"è½¬æ–‡å­—"åŠŸèƒ½

- ğŸ” **ç™»å½•ç³»ç»Ÿ**ï¼ˆv1.8.1 - æœ€æ–°ï¼‰
  - ç®€å•ç™»å½•éªŒè¯
  - Material 3 æ¸å˜èƒŒæ™¯
  - å¯†ç å¯è§æ€§åˆ‡æ¢
  
- ğŸ’¬ **æ™ºèƒ½å¯¹è¯æ‘˜è¦**
  - è‡ªåŠ¨å‹ç¼©å†å²å¯¹è¯ï¼ˆTokenèŠ‚çœ84-92%ï¼‰
  - æ”¯æŒæ— é™è½®å¯¹è¯
  - ä¸Šä¸‹æ–‡æ™ºèƒ½ä¿ç•™

- ğŸ¨ **ç°ä»£UIè®¾è®¡**
  - Material Design 3
  - æ‰“å­—æœºåŠ¨ç”»æ•ˆæœ
  - æµç•…çš„äº¤äº’ä½“éªŒ
  
- âš¡ **é«˜æ€§èƒ½ä¼˜åŒ–**
  - LRUç¼“å­˜æœºåˆ¶ï¼ˆå›¾ç‰‡æ¸²æŸ“æå‡10-40å€ï¼‰
  - å¼‚æ­¥è§£ç ä¸å‹ç¼©
  - å†…å­˜æ³„æ¼é˜²æŠ¤

- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**
  - Roomæ•°æ®åº“ï¼ˆç‰ˆæœ¬8ï¼‰
  - ä¼šè¯å†å²ç®¡ç†
  - æ‘˜è¦è‡ªåŠ¨ä¿å­˜
  - å¤šæ¨¡æ€ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆimageDescriptionå­—æ®µï¼‰

- ğŸŒ **ç½‘ç»œä¼˜åŒ–**ï¼ˆv1.8.1ï¼‰
  - è¯­éŸ³è¯†åˆ«å¤±è´¥å‹å¥½æç¤º
  - è‡ªåŠ¨åŒºåˆ†è¶…æ—¶ã€è¿æ¥å¤±è´¥ç­‰é”™è¯¯
  - ç”¨æˆ·å‹å¥½çš„ä¸­æ–‡é”™è¯¯æ¶ˆæ¯

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æŠ€æœ¯æ ˆ

```
UIå±‚ï¼šJetpack Compose + Material 3
â”œâ”€â”€ çŠ¶æ€ç®¡ç†ï¼šStateFlow + ViewModel
â”œâ”€â”€ å¯¼èˆªï¼šNavigation Component
â””â”€â”€ åŠ¨ç”»ï¼šAnimation API

ä¸šåŠ¡å±‚ï¼šMVVMæ¶æ„
â”œâ”€â”€ ViewModelï¼šä¸šåŠ¡é€»è¾‘ + çŠ¶æ€ç®¡ç†
â”œâ”€â”€ Repositoryï¼šæ•°æ®ä»“åº“ï¼ˆéšå¼ï¼‰
â””â”€â”€ Managerï¼šæ™ºèƒ½æ‘˜è¦ç®¡ç†å™¨

æ•°æ®å±‚ï¼š
â”œâ”€â”€ ç½‘ç»œï¼šOkHttp + Kotlinåç¨‹
â”œâ”€â”€ æ•°æ®åº“ï¼šRoomï¼ˆv5ï¼‰
â”‚   â”œâ”€â”€ chat_messagesè¡¨
â”‚   â””â”€â”€ session_summariesè¡¨
â””â”€â”€ ç¼“å­˜ï¼šLRU Cache
```

### âš ï¸ è±†åŒ…å®æ—¶å¯¹è¯é…ç½®è¯´æ˜ï¼ˆv1.8.2 é‡è¦æ›´æ–°ï¼‰

**1. SSL è¯ä¹¦é—®é¢˜ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼š**
- ä¸ºè§£å†³ `openspeech.bytedance.com` SSL è¯ä¹¦éªŒè¯å¤±è´¥ï¼Œå½“å‰ç‰ˆæœ¬ä¸´æ—¶**ç¦ç”¨äº† SSL è¯ä¹¦éªŒè¯**
- âš ï¸ **ä»…ç”¨äºå¼€å‘/æµ‹è¯•**ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨æ­£ç¡®çš„è¯ä¹¦éªŒè¯
- ä½ç½®ï¼š`DoubaoRealtimeService.kt` ç¬¬ 85-100 è¡Œï¼ˆè‡ªå®šä¹‰ TrustManagerï¼‰

**2. è®¤è¯é…ç½®ï¼ˆå¿…é¡»æ­£ç¡®å¡«å†™ï¼‰ï¼š**

åœ¨ `AppConfig.kt` ä¸­é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

```kotlin
const val DOUBAO_APP_ID = "ä½ çš„AppID"        // ä»ç«å±±å¼•æ“æ§åˆ¶å°è·å–
const val DOUBAO_ACCESS_KEY = "ä½ çš„AccessKey" // ä»ç«å±±å¼•æ“æ§åˆ¶å°è·å–
const val DOUBAO_APP_KEY = "PlgvMymc7f3tQnJ6" // å›ºå®šå€¼ï¼ˆå®˜æ–¹æ–‡æ¡£è§„å®šï¼‰
```

**ğŸ”‘ å¦‚ä½•è·å– AppID å’Œ AccessKeyï¼š**
1. è®¿é—® [ç«å±±å¼•æ“æ§åˆ¶å°](https://console.volcengine.com/speech)
2. å¼€é€š **è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¤§æ¨¡å‹** æœåŠ¡
3. åœ¨æ§åˆ¶å°æŸ¥çœ‹ AppID å’Œ Access Key
4. **æ³¨æ„**ï¼š`DOUBAO_APP_KEY` æ˜¯å›ºå®šå€¼ `PlgvMymc7f3tQnJ6`ï¼ˆæ ¹æ®å®˜æ–¹æ–‡æ¡£ 2.1 èŠ‚ï¼‰

**3. å¸¸è§è¿æ¥é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š**

| é”™è¯¯ç°è±¡ | HTTP ç  | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|--------|---------|---------|
| `Expected HTTP 101 but was '200 OK'` | 200 | AppID/AccessKey ä¸æ­£ç¡® | é‡æ–°æ£€æŸ¥æ§åˆ¶å°çš„ AppID å’Œ AccessKey æ˜¯å¦å¤åˆ¶æ­£ç¡® |
| `Unauthorized` | 401 | è®¤è¯å¤±è´¥ | ç¡®è®¤ AppID å’Œ AccessKey æ˜¯å¦åŒ¹é…åŒä¸€ä¸ªè´¦å· |
| `Forbidden` | 403 | æœåŠ¡æœªå¼€é€šæˆ–é…é¢ä¸è¶³ | åœ¨ç«å±±å¼•æ“æ§åˆ¶å°å¼€é€šæœåŠ¡å¹¶æ£€æŸ¥ QPM/TPM é…é¢ |
| `SSLHandshakeException` | - | SSL è¯ä¹¦ä¸å—ä¿¡ä»» | å½“å‰ç‰ˆæœ¬å·²ç¦ç”¨éªŒè¯ï¼Œå¦‚ä»æŠ¥é”™è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ |
| `Unable to resolve host` | - | ç½‘ç»œè¿æ¥é—®é¢˜ | æ£€æŸ¥è®¾å¤‡èƒ½å¦è®¿é—® openspeech.bytedance.com |

**4. è°ƒè¯•æŠ€å·§ï¼š**
- åœ¨ Logcat ä¸­è¿‡æ»¤ `DoubaoRealtime` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
- æˆåŠŸè¿æ¥ä¼šæ˜¾ç¤ºï¼š`âœ… WebSocket è¿æ¥æˆåŠŸ` å’ŒæœåŠ¡ç«¯ LogID
- è¿æ¥å¤±è´¥ä¼šæ˜¾ç¤ºå®Œæ•´çš„ HTTP çŠ¶æ€ç ã€å“åº”å¤´å’Œå“åº”ä½“

---

### é¡¹ç›®ç»“æ„ï¼ˆæ¨¡å—åŒ–è®¾è®¡ï¼‰

```
com.example.compose.jetchat/
â”œâ”€â”€ config/                       # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ AppConfig.kt             # APIå¯†é’¥ã€æ¨¡å‹é…ç½®ã€è¶…æ—¶è®¾ç½®
â”‚
â”œâ”€â”€ data/                         # æ•°æ®å±‚
â”‚   â”œâ”€â”€ api/                     # ç½‘ç»œå±‚ï¼ˆv1.8.2æ¨¡å—åŒ–é‡æ„ï¼‰
â”‚   â”‚   â”œâ”€â”€ ApiService.kt        # âš ï¸ å·²å¼ƒç”¨ï¼ˆé—¨é¢æ¨¡å¼ï¼Œç”¨äºå…¼å®¹ï¼‰
â”‚   â”‚   â”œâ”€â”€ IntentDetectionService.kt  # æ„å›¾è¯†åˆ«æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ChatService.kt       # æ–‡æœ¬å¯¹è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ImageGenerationService.kt  # å›¾ç‰‡ç”ŸæˆæœåŠ¡
â”‚   â”‚   â””â”€â”€ ImageCompressionService.kt # å›¾ç‰‡å‹ç¼©æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“å±‚ï¼ˆRoom v8ï¼‰
â”‚   â”‚   â”œâ”€â”€ AppDatabase.kt       # æ•°æ®åº“å®šä¹‰ä¸è¿ç§»
â”‚   â”‚   â”œâ”€â”€ ChatDao.kt           # æ¶ˆæ¯æ•°æ®è®¿é—®å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ ChatMessageEntity.kt # æ¶ˆæ¯å®ä½“ï¼ˆå«imageDescriptionï¼‰
â”‚   â”‚   â”œâ”€â”€ SessionSummaryDao.kt # æ‘˜è¦æ•°æ®è®¿é—®å¯¹è±¡
â”‚   â”‚   â””â”€â”€ SessionSummaryEntity.kt # æ‘˜è¦å®ä½“
â”‚   â”‚
â”‚   â”œâ”€â”€ summary/                 # å¯¹è¯æ‘˜è¦
â”‚   â”‚   â””â”€â”€ ConversationSummaryManager.kt # æ™ºèƒ½æ‘˜è¦ç”Ÿæˆä¸ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ voice/                   # è¯­éŸ³æœåŠ¡ï¼ˆv1.8.0æ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ CloudVoiceRecognizer.kt    # Whisperäº‘ç«¯è¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ DoubaoRealtimeService.kt   # è±†åŒ…å®æ—¶å¯¹è¯ï¼ˆWebSocketï¼‰
â”‚   â”‚   â”œâ”€â”€ LocalSpeechRecognizer.kt   # æœ¬åœ°è¯­éŸ³è¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ VoiceRealtimeService.kt    # OpenAIå®æ—¶è¯­éŸ³
â”‚   â”‚   â””â”€â”€ VoiceTTSService.kt         # TTSè¯­éŸ³åˆæˆ
â”‚   â”‚
â”‚   â””â”€â”€ utils/                   # å·¥å…·ç±»
â”‚       â””â”€â”€ DocumentProcessor.kt # æ–‡æ¡£å¤„ç†ï¼ˆPDF/DOC/TXTï¼‰
â”‚
â”œâ”€â”€ ui/                           # UIå±‚ï¼ˆJetpack Composeï¼‰
â”‚   â”œâ”€â”€ chat/                    # èŠå¤©ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ ChatMessage.kt       # æ¶ˆæ¯æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ ChatScreen.kt        # èŠå¤©UIï¼ˆå«è¯­éŸ³æ°”æ³¡ï¼‰
â”‚   â”‚   â”œâ”€â”€ ChatViewModel.kt     # èŠå¤©ä¸šåŠ¡é€»è¾‘ï¼ˆMVVMæ ¸å¿ƒï¼‰
â”‚   â”‚   â””â”€â”€ ImageCache.kt        # LRUå›¾ç‰‡ç¼“å­˜
â”‚   â”‚
â”‚   â”œâ”€â”€ chatlist/                # ä¼šè¯åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ ChatListScreen.kt    # åˆ—è¡¨UI
â”‚   â”‚   â””â”€â”€ ChatListViewModel.kt # åˆ—è¡¨é€»è¾‘
â”‚   â”‚
â”‚   â””â”€â”€ login/                   # ç™»å½•ç•Œé¢ï¼ˆv1.8.1æ–°å¢ï¼‰
â”‚       â””â”€â”€ LoginScreen.kt       # ç™»å½•UIä¸éªŒè¯
â”‚
â”œâ”€â”€ theme/                        # ä¸»é¢˜é…ç½®ï¼ˆMaterial 3ï¼‰
â”‚   â”œâ”€â”€ Color.kt                 # é¢œè‰²å®šä¹‰
â”‚   â”œâ”€â”€ Themes.kt                # ä¸»é¢˜é…ç½®
â”‚   â””â”€â”€ Typography.kt            # å­—ä½“æ’ç‰ˆ
â”‚
â”œâ”€â”€ JetchatApp.kt                # åº”ç”¨å¯¼èˆªå…¥å£ï¼ˆNavHostï¼‰
â””â”€â”€ MainActivity.kt              # ä¸»Activityï¼ˆComposeå®¿ä¸»ï¼‰
```

**æ¨¡å—åŒ–è®¾è®¡åŸåˆ™ï¼š**
- âœ… **é«˜å†…èš**ï¼šæ¯ä¸ªåŒ…èŒè´£å•ä¸€æ˜ç¡®
- âœ… **ä½è€¦åˆ**ï¼šUIå±‚ä¸ç›´æ¥ä¾èµ–æ•°æ®å±‚
- âœ… **å¯æµ‹è¯•**ï¼šViewModelå’ŒManagerå¯ç‹¬ç«‹æµ‹è¯•
- âœ… **å¯æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’Œæ–°æ¨¡å—

**APIæœåŠ¡å±‚æ¶æ„ï¼ˆv1.8.2é‡æ„ï¼‰ï¼š**

```
data/api/ (æ¨¡å—åŒ–æœåŠ¡æ¶æ„)
â”œâ”€â”€ IntentDetectionService.kt   # æ„å›¾è¯†åˆ«æœåŠ¡
â”‚   â”œâ”€â”€ IntentTypeæšä¸¾ï¼šTEXT_CHAT, IMAGE_GENERATION, IMAGE_RECOGNITION
â”‚   â”œâ”€â”€ IntentResultæ•°æ®ç±»ï¼štype, confidence, optimizedPrompt
â”‚   â”œâ”€â”€ RegexIntentDetectorï¼šæ­£åˆ™è¡¨è¾¾å¼å¿«é€ŸåŒ¹é…
â”‚   â””â”€â”€ AIIntentDetectorï¼šAIæ¨¡å‹é«˜å‡†ç¡®ç‡è¯†åˆ«ï¼ˆè‡ªåŠ¨é™çº§ï¼‰
â”‚
â”œâ”€â”€ ChatService.kt              # æ–‡æœ¬å¯¹è¯æœåŠ¡
â”‚   â”œâ”€â”€ chat()ï¼šå®Œæ•´å¯¹è¯APIï¼ˆæ”¯æŒå¤šè½®å†å²ï¼‰
â”‚   â”œâ”€â”€ sendMessage()ï¼šç®€åŒ–APIï¼ˆå•æ¡æ¶ˆæ¯ï¼‰
â”‚   â””â”€â”€ æ”¯æŒå¤šæ¨¡æ€ï¼šæ–‡æœ¬ + å›¾ç‰‡æ•°ç»„
â”‚
â”œâ”€â”€ ImageGenerationService.kt   # å›¾ç‰‡ç”ŸæˆæœåŠ¡
â”‚   â”œâ”€â”€ generateImage()ï¼šæ ¸å¿ƒç”ŸæˆAPIï¼ˆå¯é…ç½®å°ºå¯¸ã€è´¨é‡ï¼‰
â”‚   â””â”€â”€ generateImageWithOptimizedPrompt()ï¼šä½¿ç”¨AIä¼˜åŒ–Prompt
â”‚
â”œâ”€â”€ ImageCompressionService.kt  # å›¾ç‰‡å‹ç¼©æœåŠ¡
â”‚   â”œâ”€â”€ downloadAndCompressImage()ï¼šä¸‹è½½ + å‹ç¼© + Base64ç¼–ç 
â”‚   â”œâ”€â”€ compressBitmap()ï¼šBitmapå‹ç¼©ï¼ˆå¯é…ç½®å°ºå¯¸ã€è´¨é‡ï¼‰
â”‚   â””â”€â”€ decodeBase64ToBitmap()ï¼šBase64è§£ç ä¸ºBitmap
â”‚
â””â”€â”€ ApiService.kt (âš ï¸ Deprecated) # é—¨é¢æ¨¡å¼ï¼ˆå‘åå…¼å®¹ï¼‰
    â””â”€â”€ æ‰€æœ‰æ–¹æ³•å§”æ‰˜ç»™ä¸Šè¿°ç‹¬ç«‹æœåŠ¡

è®¾è®¡ä¼˜åŠ¿ï¼š
âœ… å•ä¸€èŒè´£åŸåˆ™ (SRP) - æ¯ä¸ªæœåŠ¡åªåšä¸€ä»¶äº‹
âœ… å¼€é—­åŸåˆ™ (OCP) - å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
âœ… ä¾èµ–å€’ç½®åŸåˆ™ (DIP) - é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—
âœ… æ¥å£éš”ç¦»åŸåˆ™ (ISP) - å®¢æˆ·ç«¯ä¸åº”ä¾èµ–ä¸éœ€è¦çš„æ¥å£
âœ… é—¨é¢æ¨¡å¼ (Facade) - ä¿æŒå‘åå…¼å®¹ï¼Œå¹³æ»‘è¿ç§»
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Android Studio**: Hedgehog | 2023.1.1 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Kotlin**: 1.9.0+
- **Android SDK**: API 24+ (Android 7.0+)
- **JDK**: 17

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/yourusername/Jetchat.git
   cd Jetchat
   ```

2. **é…ç½®APIå¯†é’¥**
   
   ç¼–è¾‘ `app/src/main/java/com/example/compose/jetchat/config/AppConfig.kt`ï¼š
   ```kotlin
   object AppConfig {
       const val API_KEY = "your-api-key-here"  // æ›¿æ¢ä¸ºä½ çš„APIå¯†é’¥
       const val CHAT_API_URL = "https://api.vectorengine.ai/v1/chat/completions"
       const val IMAGE_API_URL = "https://api.vectorengine.ai/v1/images/generations"
   }
   ```

3. **åŒæ­¥ä¾èµ–**
   ```bash
   ./gradlew build
   ```

4. **è¿è¡Œåº”ç”¨**
   - åœ¨Android Studioä¸­ç‚¹å‡» Run æŒ‰é’®
   - æˆ–ä½¿ç”¨å‘½ä»¤è¡Œï¼š`./gradlew installDebug`

### è·å–APIå¯†é’¥

è®¿é—® [VectorEngine](https://vectorengine.ai) æ³¨å†Œå¹¶è·å–å…è´¹APIå¯†é’¥ã€‚

---

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. æ™ºèƒ½å¯¹è¯æ‘˜è¦ç³»ç»Ÿ

**é—®é¢˜ï¼š** AIå¯¹è¯æœ‰Tokené™åˆ¶ï¼Œé•¿å¯¹è¯ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡ä¸¢å¤±æˆ–è¯·æ±‚å¤±è´¥ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** æ™ºèƒ½æ‘˜è¦ç³»ç»Ÿ
- æ¯10è½®å¯¹è¯è‡ªåŠ¨è§¦å‘æ‘˜è¦ç”Ÿæˆ
- ä¿ç•™æœ€è¿‘6è½®å®Œæ•´å¯¹è¯
- æ‘˜è¦å‹ç¼©æ—§å¯¹è¯ï¼ŒèŠ‚çœToken 84-92%
- æ”¯æŒæ— é™è½®å¯¹è¯

```kotlin
// æ‘˜è¦è§¦å‘é€»è¾‘
if (messages.size >= SUMMARY_INTERVAL) {
    generateSummary(sessionId)
}

// å‘é€æ¶ˆæ¯æ—¶ç»„è£…ä¸Šä¸‹æ–‡
val messagesWithSummary = if (hasSummary) {
    [æ‘˜è¦] + [æœ€è¿‘6è½®å®Œæ•´å¯¹è¯] + [å½“å‰è¾“å…¥]
} else {
    [æ‰€æœ‰å†å²å¯¹è¯] + [å½“å‰è¾“å…¥]
}
```

**æ•ˆæœï¼š**
- 20è½®å¯¹è¯ï¼š8000 tokens â†’ 1200 tokens
- ä¸Šä¸‹æ–‡ç†è§£å‡†ç¡®ç‡ï¼š95%+
- æ”¯æŒ100+è½®å¯¹è¯

### 2. å¤šæ¨¡æ€AIäº¤äº’

**æ–‡æœ¬å¯¹è¯**
- æ¨¡å‹ï¼šGemini 2.5 Pro
- æ”¯æŒä¸Šä¸‹æ–‡ç†è§£
- æ‰“å­—æœºåŠ¨ç”»æ•ˆæœ

**å›¾ç‰‡è¯†åˆ«**
- ä¸Šä¼ å›¾ç‰‡å¹¶æé—®
- AIç†è§£å›¾ç‰‡å†…å®¹
- å¤šæ¨¡æ€æ¶ˆæ¯ç»„è£…

**å›¾ç‰‡ç”Ÿæˆï¼ˆAIå¢å¼ºï¼‰** ğŸ†•
- **AIæ„å›¾è¯†åˆ«** - ä½¿ç”¨Gemini 2.5 Flashæ¨¡å‹æ™ºèƒ½è¯†åˆ«ç”¨æˆ·æ„å›¾
- **Promptè‡ªåŠ¨ä¼˜åŒ–** - å°†ä¸­æ–‡æè¿°è½¬æ¢ä¸ºä¸“ä¸šè‹±æ–‡Prompt
- **è‡ªåŠ¨è°ƒç”¨DALL-E 3** - ç”Ÿæˆé«˜è´¨é‡å›¾ç‰‡
- **æ™ºèƒ½é™çº§ä¿æŠ¤** - AIå¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°æ­£åˆ™è¡¨è¾¾å¼
- **ç½®ä¿¡åº¦è¯„ä¼°** - åˆ¤æ–­è¯†åˆ«å‡†ç¡®æ€§

```kotlin
// AIæ„å›¾æ£€æµ‹å™¨
interface IntentDetector {
    suspend fun detectIntent(message: String, hasImage: Boolean): IntentResult
}

data class IntentResult(
    val type: IntentType,  // IMAGE_GENERATION / TEXT_CHAT
    val confidence: Float,  // 0-1ç½®ä¿¡åº¦
    val optimizedPrompt: String?  // ä¼˜åŒ–åçš„è‹±æ–‡Prompt
)
```

### 3. è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶å¯¹è¯ ğŸ™ï¸

**åŠŸèƒ½æ¦‚è¿°ï¼š**
å®Œæ•´é›†æˆå­—èŠ‚è·³åŠ¨è±†åŒ… Realtime APIï¼Œå®ç°çœŸæ­£çš„ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¯¹è¯ã€‚

**æŠ€æœ¯æ¶æ„ï¼š**

```kotlin
// WebSocket è¿æ¥ç®¡ç†
class DoubaoRealtimeService {
    - WebSocket è¿æ¥å»ºç«‹
    - äºŒè¿›åˆ¶åè®®å°è£…
    - éŸ³é¢‘æµå®æ—¶ä¼ è¾“
    - äº‹ä»¶ç›‘å¬ä¸å¤„ç†
}

// æ¶ˆæ¯æµç¨‹
ç”¨æˆ·è¯´è¯ â†’ AudioRecord(16kHz PCM)
         â†’ Binary Frame (Header + Audio Payload)
         â†’ WebSocket å‘é€
         â†’ è±†åŒ… ASR è¯†åˆ«
         â†’ EVENT_ASR_ENDED (è¯†åˆ«ç»“æœ)
         â†’ æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯æ°”æ³¡

è±†åŒ… AI å›å¤ â†’ EVENT_CHAT_ENDED (AIæ–‡æœ¬)
            â†’ æ˜¾ç¤º AI æ¶ˆæ¯æ°”æ³¡(æ‰“å­—æœºæ•ˆæœ)
            â†’ è±†åŒ… TTS åˆæˆ
            â†’ EVENT_TTS_ENDED (éŸ³é¢‘æ•°æ®)
            â†’ AudioTrack æ’­æ”¾(24kHz)
```

**äºŒè¿›åˆ¶åè®®å®ç°ï¼š**

```kotlin
// åè®®æ ¼å¼ï¼šHeader(12å­—èŠ‚) + Payload
Header:
- Magic Number (0x1234)
- Protocol Version (0x0001)
- Header Size (12)
- Payload Type (0x00=Audio, 0x01=Text)
- Serialization (0x10=JSON + NoCompression)
- Message Type (0x0001=Clientâ†’Server)
- Payload Size (4å­—èŠ‚)

// å…³é”®ä¿®å¤
âœ… Byte2 ä¿®æ­£ï¼š0x10 (JSON + NoCompression)
âœ… ç§»é™¤ connectIdï¼šåªåœ¨ HTTP Header ä¸­
âœ… æ­£ç¡®çš„å¸§ç»“æ„ï¼šç¬¦åˆå®˜æ–¹æ–‡æ¡£
```

**å…³é”®ä¼˜åŒ–ï¼š**

1. **é˜²æŠ–æœºåˆ¶** - é¿å…é‡å¤å‘é€
   ```kotlin
   private var lastVoiceTranscription: String = ""
   private var voiceRecognitionJob: Job? = null
   
   // å¯åŠ¨å‰å–æ¶ˆæ—§ç›‘å¬å™¨
   voiceRecognitionJob?.cancel()
   voiceRecognitionJob = viewModelScope.launch { ... }
   ```

2. **ä¼šè¯ç®¡ç†** - è‡ªåŠ¨è¯†åˆ«å®æ—¶å¯¹è¯ä¼šè¯
   ```kotlin
   val isRealtime = session.title.contains("ğŸ™ï¸") || 
                    session.title.contains("å®æ—¶è¯­éŸ³")
   ```

3. **UI åŠ¨ç”»** - å‘¼å¸åŠ¨ç”»éº¦å…‹é£å°çƒ
   ```kotlin
   val scale by infiniteTransition.animateFloat(
       initialValue = 1f, targetValue = 1.3f,
       animationSpec = infiniteRepeatable(
           animation = tween(600, easing = FastOutSlowInEasing),
           repeatMode = RepeatMode.Reverse
       )
   )
   ```

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- éŸ³é¢‘å»¶è¿Ÿï¼š< 100ms
- è¯†åˆ«å‡†ç¡®ç‡ï¼š95%+ï¼ˆè±†åŒ… ASRï¼‰
- ç½‘ç»œæµé‡ï¼š~20KB/ç§’ï¼ˆ16kHz PCMï¼‰
- å†…å­˜å ç”¨ï¼šç¨³å®šåœ¨ 80-85MB

**è°ƒè¯•æ—¥å¿—ç¤ºä¾‹ï¼š**
```
âœ“ WebSocket è¿æ¥æˆåŠŸ
âœ“ StartConnection å‘é€æˆåŠŸ  
âœ“ EVENT_CONNECTION_ESTABLISHED - ä¼šè¯å·²å»ºç«‹
âœ“ å¼€å§‹å½•éŸ³å¹¶å‘é€éŸ³é¢‘æµ...
âœ“ EVENT_ASR_SEGMENT - å®æ—¶è¯†åˆ«: "ä½ å¥½"
âœ“ EVENT_ASR_ENDED - æœ€ç»ˆæ–‡æœ¬: "ä½ å¥½è±†åŒ…"
âœ“ ç”¨æˆ·æ¶ˆæ¯å·²æ¸²æŸ“ â†’ å³è¾¹æ°”æ³¡
âœ“ EVENT_CHAT_SEGMENT - AIå›å¤ç‰‡æ®µ: "ä½ å¥½..."
âœ“ EVENT_CHAT_ENDED - AIå®Œæ•´å›å¤: "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"
âœ“ AIæ¶ˆæ¯å·²æ¸²æŸ“ â†’ å·¦è¾¹æ°”æ³¡ï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
âœ“ TTS éŸ³é¢‘æ’­æ”¾ä¸­...
```

---

### 4. é«˜æ€§èƒ½å›¾ç‰‡æ¸²æŸ“ âš¡

**ä¼˜åŒ–å‰ï¼š** 87ç§’ä¸‹è½½+å¤„ç†ï¼Œä¸¥é‡å¡é¡¿ï¼Œ3MB PNGæ–‡ä»¶

**v1.5.0æé€Ÿä¼˜åŒ–ï¼š**
1. **è¯·æ±‚512x512å°å›¾** - ä»3MBé™åˆ°800KBï¼ˆå‡å°‘70%ä¸‹è½½æ—¶é—´ï¼‰ ğŸ†•
2. **æµå¼è§£ç ** - è¾¹ä¸‹è½½è¾¹å¤„ç†ï¼Œæ— éœ€ç­‰å¾…å®Œæ•´ä¸‹è½½ ğŸ†•
3. **é™ä½æ˜¾ç¤ºå°ºå¯¸** - 200pxè¶³å¤Ÿç§»åŠ¨ç«¯æ¸…æ™°æ˜¾ç¤º ğŸ†•
4. **inSampleSizeè§£ç æ—¶ç¼©æ”¾** - å‡å°‘å†…å­˜å ç”¨
5. **RGB_565æ ¼å¼** - 2å­—èŠ‚/åƒç´ ï¼ˆvs 4å­—èŠ‚ï¼‰
6. **JPEGå‹ç¼©** - è´¨é‡75%ï¼Œä½“ç§¯ä¼˜åŒ–
7. **LRUç¼“å­˜** - é¿å…é‡å¤è§£ç 
8. **å¼‚æ­¥è§£ç ** - åå°çº¿ç¨‹å¤„ç†
9. **ç‹¬ç«‹è¶…æ—¶æ§åˆ¶** - å›¾ç‰‡ä¸‹è½½30ç§’è¶…æ—¶ ğŸ†•

**æ€§èƒ½æå‡ï¼š**
- ä¸‹è½½æ—¶é—´ï¼š87ç§’ â†’ **5-8ç§’**ï¼ˆæå‡90%+ï¼‰
- æœ€ç»ˆå¤§å°ï¼š3MB â†’ **15-20KB**ï¼ˆå‡å°‘99%ï¼‰
- å†…å­˜å ç”¨ï¼š~12MB â†’ **<1MB**ï¼ˆå‡å°‘92%ï¼‰

```kotlin
// LRUç¼“å­˜å®ç°
object ImageCache {
    private val bitmapCache = LruCache<String, Bitmap>(cacheSize) {
        override fun sizeOf(key, bitmap) = bitmap.byteCount / 1024
    }
    
    suspend fun decodeBitmap(base64: String): Bitmap? {
        return bitmapCache.get(key) ?: decode(base64).also {
            bitmapCache.put(key, it)
        }
    }
}
```

**ä¼˜åŒ–åï¼š**
- é¦–æ¬¡æ¸²æŸ“ï¼š0.2-0.5ç§’ï¼ˆ**10-40å€æå‡**ï¼‰
- ç¼“å­˜å‘½ä¸­ï¼š1-10msï¼ˆ**500-8000å€æå‡**ï¼‰
- å†…å­˜ç¨³å®šï¼š70-75MB
- æ— å†…å­˜æ³„æ¼

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| **å¯åŠ¨æ—¶é—´** | < 2ç§’ | å†·å¯åŠ¨åˆ°é¦–å±æ¸²æŸ“ |
| **é¦–å±æ¸²æŸ“** | < 1ç§’ | èŠå¤©ç•Œé¢åŠ è½½ |
| **å›¾ç‰‡æ¸²æŸ“ï¼ˆé¦–æ¬¡ï¼‰** | 0.2-0.5ç§’ | åŒ…å«è§£ç å’Œå‹ç¼© |
| **å›¾ç‰‡æ¸²æŸ“ï¼ˆç¼“å­˜ï¼‰** | 1-10ms | LRUç¼“å­˜å‘½ä¸­ |
| **å†…å­˜å ç”¨** | 65-85MB | ç¨³å®šè¿è¡Œï¼ˆå®æ—¶å¯¹è¯80-85MBï¼‰ |
| **TokenèŠ‚çœ** | 84-92% | æ‘˜è¦ç³»ç»Ÿæ•ˆæœ |
| **å¯¹è¯é•¿åº¦** | æ— é™åˆ¶ | æ”¯æŒ100+è½® |
| **è¯­éŸ³å»¶è¿Ÿ** | < 100ms | è±†åŒ…å®æ—¶å¯¹è¯ |
| **ASRå‡†ç¡®ç‡** | 95%+ | è±†åŒ…è¯­éŸ³è¯†åˆ« |

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•

```bash
./gradlew test
```

### è¿è¡ŒUIæµ‹è¯•

```bash
./gradlew connectedAndroidTest
```

### æµ‹è¯•è¦†ç›–

- âœ… å¯¹è¯å‘é€ä¸æ¥æ”¶
- âœ… å›¾ç‰‡è¯†åˆ«ä¸ç”Ÿæˆ
- âœ… æ‘˜è¦è§¦å‘ä¸ä¿å­˜
- âœ… æ•°æ®åº“è¯»å†™
- âœ… ç½‘ç»œå¼‚å¸¸å¤„ç†
- âœ… å†…å­˜æ³„æ¼æ£€æµ‹

---

## ğŸ”§ é…ç½®é€‰é¡¹ï¼ˆæ˜“äºè°ƒæ•´ï¼‰

åœ¨ `AppConfig.kt` ä¸­å¯ä»¥è°ƒæ•´ä»¥ä¸‹å‚æ•°ï¼š

```kotlin
object AppConfig {
    // APIé…ç½®
    const val API_KEY = "your-key"
    const val CHAT_MODEL = "gemini-2.5-pro"
    const val IMAGE_MODEL = "dall-e-3"
    
    // æ‘˜è¦é…ç½®
    const val SUMMARY_INTERVAL = 10        // æ¯10è½®è§¦å‘æ‘˜è¦
    const val RECENT_MESSAGES_COUNT = 6    // ä¿ç•™6è½®å®Œæ•´å¯¹è¯
    
    // æ€§èƒ½é…ç½®
    const val MAX_IMAGE_SIZE = 256         // å›¾ç‰‡æœ€å¤§å°ºå¯¸
    const val IMAGE_QUALITY = 60           // JPEGè´¨é‡
    const val TIMEOUT_SECONDS = 60L        // ç½‘ç»œè¶…æ—¶
    
    // è°ƒè¯•é…ç½®
    const val ENABLE_LOGGING = true        // å¯ç”¨æ—¥å¿—
}
```

---

## ğŸ”„ å¯ç»´æŠ¤æ€§ä¸å¯è¿­ä»£æ€§è®¾è®¡

### ä»£ç è´¨é‡ä¿è¯

- âœ… **å‘½åè§„èŒƒ**ï¼šæ¸…æ™°çš„å˜é‡ã€å‡½æ•°ã€ç±»å‘½å
- âœ… **æ³¨é‡Šç­–ç•¥**ï¼šå…³é”®é€»è¾‘æœ‰è¯¦ç»†æ³¨é‡Š
- âœ… **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç±»/å‡½æ•°èŒè´£æ˜ç¡®
- âœ… **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸æ•è·å’Œç”¨æˆ·æç¤º
- âœ… **æ—¥å¿—ç³»ç»Ÿ**ï¼šå…³é”®è·¯å¾„æœ‰æ€§èƒ½å’ŒçŠ¶æ€æ—¥å¿—

### æ‰©å±•æ€§è®¾è®¡

1. **ç­–ç•¥æ¨¡å¼** - æ„å›¾è¯†åˆ«å¯è½»æ¾ä»æ­£åˆ™å‡çº§ä¸ºAIæ¨¡å‹
   ```kotlin
   interface IntentDetector {
       suspend fun detectIntent(message: String): IntentType
   }
   ```

2. **é…ç½®åŒ–** - æ‰€æœ‰é…ç½®é›†ä¸­åœ¨AppConfigï¼Œæ˜“äºè°ƒæ•´

3. **æ¥å£é¢„ç•™** - ä¸ºè¯­éŸ³ã€æœç´¢ã€æ–‡ä»¶ä¸Šä¼ é¢„ç•™äº†æ‰©å±•ç‚¹

### ç‰ˆæœ¬ç®¡ç†

- ä½¿ç”¨Gitåˆ†æ”¯ç­–ç•¥ï¼ˆmain/develop/featureï¼‰
- éµå¾ªCommitè§„èŒƒï¼ˆfeat/fix/perf/refactorï¼‰
- å®Œæ•´çš„ç‰ˆæœ¬å‘å¸ƒè®°å½•
- æ•°æ®åº“è¿ç§»ç­–ç•¥

è¯¦è§ï¼š[å¼€å‘æŠ¥å‘Š-AIè¾…åŠ©å¼€å‘å®è·µä¸äººå·¥ä»·å€¼ä½“ç°.md](å¼€å‘æŠ¥å‘Š-AIè¾…åŠ©å¼€å‘å®è·µä¸äººå·¥ä»·å€¼ä½“ç°.md)

---

## ğŸ“ å·²çŸ¥é—®é¢˜ä¸è®¡åˆ’

### å·²çŸ¥é—®é¢˜

- å›¾ç‰‡ç”Ÿæˆå¶å°”ä¼šè¿”å›500é”™è¯¯ï¼ˆå·²å®ç°æ™ºèƒ½é™çº§ï¼‰
- æ„å›¾è¯†åˆ«ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¤æ‚è¯­ä¹‰å¯èƒ½è¯†åˆ«å¤±è´¥

### æœªæ¥è®¡åˆ’

- [ ] å‡çº§æ„å›¾è¯†åˆ«ä¸ºAIæ¨¡å‹
- [x] ~~æ·»åŠ è¯­éŸ³è¾“å…¥/è¾“å‡º~~ âœ… å·²å®Œæˆï¼ˆv1.7.0ï¼‰
- [x] ~~è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶å¯¹è¯~~ âœ… å·²å®Œæˆï¼ˆv1.7.0ï¼‰
- [ ] æ”¯æŒè”ç½‘æœç´¢
- [x] ~~æ”¯æŒæ–‡ä»¶ä¸Šä¼ ~~ âœ… å·²å®Œæˆï¼ˆv1.6.0ï¼‰
- [ ] æ·»åŠ æ›´å¤šAIæ¨¡å‹æ”¯æŒï¼ˆClaudeã€GPT-4ç­‰ï¼‰
- [ ] æ”¯æŒä¼šè¯å¯¼å‡º/åˆ†äº«
- [ ] è¯­éŸ³æ‰“æ–­åŠŸèƒ½ï¼ˆå®æ—¶å¯¹è¯ä¸­ï¼‰
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆASR/TTSï¼‰

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### è´¡çŒ®æŒ‡å—

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

### Commitè§„èŒƒ

- `feat`: æ–°åŠŸèƒ½
- `fix`: Bugä¿®å¤
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `refactor`: é‡æ„
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼
- `test`: æµ‹è¯•ç›¸å…³

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº Apache License 2.0 å¼€æºï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

```
Copyright 2024 Jetchat Contributors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```

---

## ğŸ‘¨â€ğŸ’» ä½œè€…ï¼šshen

- **å¼€å‘è€…** - å®Œæ•´çš„æ¶æ„è®¾è®¡ã€æ ¸å¿ƒåŠŸèƒ½å®ç°ã€æ€§èƒ½ä¼˜åŒ–
- **AIè¾…åŠ©** - éƒ¨åˆ†åŸºç¡€ä»£ç ç”Ÿæˆã€æ–‡æ¡£ç¼–å†™è¾…åŠ©

---

## ğŸ™ è‡´è°¢

- [Jetpack Compose](https://developer.android.com/jetpack/compose) - ç°ä»£UIæ¡†æ¶
- [Material Design 3](https://m3.material.io) - è®¾è®¡ç³»ç»Ÿ
- [VectorEngine](https://vectorengine.ai) - AI APIæä¾›
- [Android Open Source Project](https://source.android.com) - åŸå§‹Jetchatç¤ºä¾‹
- [OpenAI Realtime API](https://platform.openai.com/docs/guides/realtime) - å®æ—¶è¯­éŸ³å¯¹è¯æŠ€æœ¯

---

## ğŸ†• æœ€æ–°æ›´æ–°

### v1.7.0 (2025-12-02) ğŸ™ï¸ **è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶å¯¹è¯**

**ğŸš€ é‡ç£…æ–°å¢ï¼š**
- âœ… **è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶å¯¹è¯** - å®Œæ•´é›†æˆå­—èŠ‚è·³åŠ¨è±†åŒ… Realtime API
- âœ… **WebSocket åŒå·¥é€šä¿¡** - éŸ³é¢‘æµå®æ—¶ä¼ è¾“
- âœ… **å®æ—¶è¯­éŸ³è¯†åˆ« (ASR)** - è¾¹è¯´è¾¹è½¬æ–‡å­—
- âœ… **å®æ—¶è¯­éŸ³åˆæˆ (TTS)** - AI å›å¤å³æ—¶æ’­æ”¾
- âœ… **äºŒè¿›åˆ¶åè®®å®ç°** - å®Œæ•´å®ç°è±†åŒ… Binary Protocol
- âœ… **æ™ºèƒ½ä¼šè¯ç®¡ç†** - è‡ªåŠ¨ä¿å­˜å¯¹è¯å†å²
- âœ… **å‘¼å¸åŠ¨ç”» UI** - éº¦å…‹é£å°çƒè„‰å†²æ•ˆæœ

**ğŸ¯ æ ¸å¿ƒç‰¹æ€§ï¼š**
- **é›¶å»¶è¿Ÿå¯¹è¯** - éŸ³é¢‘æµç›´æ¥ä¼ è¾“ï¼Œæ— éœ€ç­‰å¾…
- **ç«¯åˆ°ç«¯åŠ å¯†** - WebSocket TLS å®‰å…¨è¿æ¥
- **ä¼šè¯æŒä¹…åŒ–** - å¯¹è¯è®°å½•è‡ªåŠ¨ä¿å­˜ï¼Œæ”¯æŒé‡æ–°è¿›å…¥
- **é˜²æŠ–æœºåˆ¶** - é¿å…æ¶ˆæ¯é‡å¤å‘é€
- **æ‰“å­—æœºæ•ˆæœ** - AI å›å¤é€å­—æ˜¾ç¤º

**ğŸ“± ä½¿ç”¨æ–¹å¼ï¼š**
1. åœ¨å¯¹è¯åˆ—è¡¨ç‚¹å‡»"â•" â†’ é€‰æ‹©"å®æ—¶è¯­éŸ³å¯¹è¯"
2. è¿›å…¥èŠå¤©ç•Œé¢ï¼Œç‚¹å‡»å³ä¸Šè§’éº¦å…‹é£å›¾æ ‡å¯åŠ¨
3. å¼€å§‹è¯´è¯ï¼Œå®æ—¶çœ‹åˆ°è¯†åˆ«ç»“æœå’Œ AI å›å¤
4. å†æ¬¡ç‚¹å‡»éº¦å…‹é£å›¾æ ‡åœæ­¢å¯¹è¯

è¯¦ç»†æŠ€æœ¯æ–‡æ¡£ï¼š[VOICE_CHAT_IMPLEMENTATION_REPORT.md](docs/VOICE_CHAT_IMPLEMENTATION_REPORT.md)

---

## ğŸ”„ æœ€æ–°æ›´æ–°

### v1.8.2 (2025-12-10) ğŸ—ï¸ **æ¶æ„é‡æ„ä¸è±†åŒ…è¯­éŸ³ä¼˜åŒ–**

**ğŸ¯ é‡å¤§é‡æ„ï¼šå•ä¸€èŒè´£åŸåˆ™ (SRP)**
- âœ… **ApiService æ¨¡å—åŒ–æ‹†åˆ†** - å°†åŸ 765 è¡Œ God Object æ‹†åˆ†ä¸º 4 ä¸ªç‹¬ç«‹æœåŠ¡

**ğŸ™ï¸ è±†åŒ…å®æ—¶è¯­éŸ³ä¼˜åŒ–ï¼š**
- âœ… **ä¿®å¤è¯­éŸ³æˆªæ–­é—®é¢˜** - `end_smooth_window_ms` ä» 1.5 ç§’å¢åŠ åˆ° 3 ç§’
  - è§£å†³è¯´è¯å†…å®¹è¾ƒé•¿æ—¶è¢«æå‰æˆªæ–­çš„é—®é¢˜
  - ä¾‹å¦‚ï¼š"ä½ çŸ¥é“ä»€ä¹ˆæ˜¯è®¡ç®—æœºå—" ä¸å†è¢«è¯†åˆ«æˆ "ä½ çŸ¥é“ä»€ä¹ˆäº‹å—"
  - æ”¯æŒè¯´è¯æ—¶çš„è‡ªç„¶åœé¡¿ï¼Œä¸ä¼šè¿‡æ—©åˆ¤å®šä¸ºè¯´è¯ç»“æŸ
- âœ… **å¢å¼ºç”¨æˆ·æ‰“æ–­åŠŸèƒ½** - ç§»é™¤"æ’­æ”¾æ—¶è·³è¿‡å½•éŸ³"çš„é™åˆ¶
  - ç”¨æˆ·å¯ä»¥éšæ—¶è¯´è¯æ‰“æ–­ AI å›å¤
  - æœåŠ¡ç«¯é€šè¿‡ `EVENT_ASR_INFO` äº‹ä»¶è‡ªåŠ¨è§¦å‘æ‰“æ–­
  - ç¡¬ä»¶å›å£°æ¶ˆé™¤(AEC)ç¡®ä¿æ‰“æ–­æ—¶æ— å›å£°å¹²æ‰°
  - æ‰“æ–­åè‡ªåŠ¨æ¸…ç©ºéŸ³é¢‘é˜Ÿåˆ—ï¼Œç«‹å³å“åº”ç”¨æˆ·æ–°è¾“å…¥
- âœ… **ä¼˜åŒ–éŸ³é¢‘æ’­æ”¾æµç•…åº¦** - å½»åº•è§£å†³ AI è¯­éŸ³"å¡é¡¿"é—®é¢˜
  - **4å€ç¼“å†²åŒº**ï¼šAudioTrack ç¼“å†²åŒºä» 2 å€å¢åŠ åˆ° 4 å€ï¼Œå‡å°‘åº•å±‚ç¼“å†²ä¸è¶³
  - **é¢„ç¼“å†²æœºåˆ¶**ï¼šç§¯ç´¯ 3 ä¸ªéŸ³é¢‘åŒ…å†æ’­æ”¾ï¼Œé¿å…åˆæœŸå¡é¡¿
  - **æ‰¹é‡å†™å…¥**ï¼šä¸€æ¬¡å†™å…¥ 5 ä¸ªéŸ³é¢‘åŒ…ï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•° 80%
  - **æ™ºèƒ½è½®è¯¢**ï¼šä¼˜åŒ–é˜Ÿåˆ—æ£€æŸ¥é—´éš”ï¼Œå‡å°‘ CPU å ç”¨
  - **å¯é…ç½®å‚æ•°**ï¼šåœ¨ `AppConfig.kt` ä¸­å¯è°ƒæ•´ç¼“å†²ç­–ç•¥
- âœ… **å¯é…ç½®åŒ–è®¾è®¡** - æ‰€æœ‰å…³é”®å‚æ•°å¯åœ¨ `AppConfig.kt` ä¸­è°ƒæ•´
  - `DOUBAO_END_SMOOTH_WINDOW_MS`ï¼šåœé¡¿åˆ¤å®šæ—¶é—´ï¼ˆ500-50000msï¼‰
  - `AUDIO_BUFFER_MULTIPLIER`ï¼šç¼“å†²åŒºå€æ•°ï¼ˆæ¨è 4-8ï¼‰
  - `PRE_BUFFER_PACKETS`ï¼šé¢„ç¼“å†²åŒ…æ•°ï¼ˆæ¨è 2-5ï¼‰
  - `BATCH_WRITE_SIZE`ï¼šæ‰¹é‡å†™å…¥å¤§å°ï¼ˆæ¨è 3-10ï¼‰
- âœ… **SSL è¯ä¹¦é—®é¢˜æ’æŸ¥** - æ·»åŠ è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼Œå¸®åŠ©è¯Šæ–­ç½‘ç»œé—®é¢˜
  - æ˜¾ç¤ºå®Œæ•´çš„ HTTP å“åº”å¤´å’Œå“åº”ä½“
  - è¯†åˆ«æ ¡å›­ç½‘è®¤è¯ã€ä»£ç†ç­‰ç½‘ç»œæ‹¦æˆªé—®é¢˜
- âœ… **IntentDetectionService** (235 è¡Œ) - æ„å›¾è¯†åˆ«ä¸“ç”¨æœåŠ¡
  - RegexIntentDetectorï¼šå¿«é€Ÿç¦»çº¿æ­£åˆ™åŒ¹é…
  - AIIntentDetectorï¼šé«˜å‡†ç¡®ç‡ AI è¯†åˆ«ï¼ˆGemini 2.5 Flashï¼‰
  - è‡ªåŠ¨é™çº§ç­–ç•¥ï¼šAI å¤±è´¥æ—¶å›é€€åˆ°æ­£åˆ™
  - ç½®ä¿¡åº¦è¯„åˆ†ï¼š0-1 æµ®ç‚¹æ•°è¡¨ç¤ºè¯†åˆ«ç½®ä¿¡åº¦
- âœ… **ChatService** (143 è¡Œ) - æ–‡æœ¬å¯¹è¯ä¸“ç”¨æœåŠ¡
  - `chat()` - å®Œæ•´å¯¹è¯ APIï¼ˆæ”¯æŒå¤šè½®å†å²ï¼‰
  - `sendMessage()` - ç®€åŒ– APIï¼ˆå•æ¡æ¶ˆæ¯ï¼‰
  - å¤šæ¨¡æ€æ”¯æŒï¼šæ–‡æœ¬ + å›¾ç‰‡æ•°ç»„æ ¼å¼
- âœ… **ImageGenerationService** (139 è¡Œ) - å›¾ç‰‡ç”Ÿæˆä¸“ç”¨æœåŠ¡
  - `generateImage()` - æ ¸å¿ƒç”Ÿæˆ API
  - `generateImageWithOptimizedPrompt()` - AI ä¼˜åŒ– Prompt
  - å¯é…ç½®å°ºå¯¸ã€è´¨é‡ã€æ¨¡å‹
- âœ… **ImageCompressionService** (162 è¡Œ) - å›¾ç‰‡å‹ç¼©ä¸“ç”¨æœåŠ¡
  - `downloadAndCompressImage()` - ç½‘ç»œå›¾ç‰‡ä¸‹è½½ + å‹ç¼©
  - `compressBitmap()` - Bitmap å‹ç¼©
  - `decodeBase64ToBitmap()` - Base64 è§£ç 

**ğŸ“ æ¶æ„ä¼˜åŠ¿ï¼š**
- ğŸ¯ **é«˜å†…èšä½è€¦åˆ** - æ¯ä¸ªæœåŠ¡èŒè´£å•ä¸€æ˜ç¡®
- ğŸ§ª **å¯æµ‹è¯•æ€§** - ç‹¬ç«‹æœåŠ¡æ˜“äºå•å…ƒæµ‹è¯•
- ğŸ”§ **å¯ç»´æŠ¤æ€§** - ä»£ç åˆ†æ•£åœ¨å¤šä¸ªå°æ–‡ä»¶ï¼Œæ˜“äºç†è§£
- ğŸš€ **å¯æ‰©å±•æ€§** - æ·»åŠ æ–°åŠŸèƒ½æ— éœ€ä¿®æ”¹ç°æœ‰æœåŠ¡
- ğŸ”„ **é—¨é¢æ¨¡å¼** - ApiService ä¿ç•™ä½œä¸ºé—¨é¢ï¼Œç¡®ä¿å‘åå…¼å®¹

**ğŸ”— å‘åå…¼å®¹æ€§ï¼š**
- âš ï¸ **ApiService æ ‡è®°ä¸º @Deprecated** - å§”æ‰˜ç»™æ–°æœåŠ¡ï¼Œä¿è¯æ—§ä»£ç æ­£å¸¸è¿è¡Œ
- ğŸ“ **IDE æç¤ºè¿ç§»è·¯å¾„** - @ReplaceWith æ³¨è§£æä¾›è‡ªåŠ¨é‡æ„å»ºè®®
- ğŸ›¡ï¸ **é›¶ç ´åæ€§å˜æ›´** - ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹å³å¯è¿è¡Œ

**ä»£ç è´¨é‡æå‡ï¼š**
- ğŸ“‰ **ä»£ç è¡Œæ•°å‡å°‘** - åŸ 765 è¡Œæ‹†åˆ†ä¸º 4 Ã— ~150 è¡Œ
- ğŸ“Š **åœˆå¤æ‚åº¦é™ä½** - æ¯ä¸ªæ–¹æ³•èŒè´£æ›´æ¸…æ™°
- ğŸ” **æ—¥å¿—åˆ†ç±»** - æ¯ä¸ªæœåŠ¡ç‹¬ç«‹æ—¥å¿—æ ‡ç­¾

---

### v1.8.1 (2025-12-05) ğŸ” **ç¨³å®šæ€§æ›´æ–°**

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… **ç™»å½•é¡µé¢** - ç®€æ´çš„ç™»å½•ç•Œé¢ï¼Œç¡¬ç¼–ç è´¦å·éªŒè¯
- âœ… **ç½‘ç»œé”™è¯¯å‹å¥½æç¤º** - è¯­éŸ³è¯†åˆ«å¤±è´¥æ—¶æ˜¾ç¤º"å¤–ç½‘è®¿é—®ç¹å¿™ï¼Œè¯·ç¨åå†è¯• ğŸŒ"
- âœ… **APK åç§°ä¼˜åŒ–** - æ„å»ºäº§ç‰©ç»Ÿä¸€å‘½åä¸º `aichat.apk`

ğŸ”§ **å…³é”®ä¿®å¤ï¼š**
- ğŸ› **ä¿®å¤ AudioTrack é‡å¯å»¶è¿Ÿ** - æ·»åŠ  `flush()` å’Œ 50ms å»¶è¿Ÿï¼Œè§£å†³ç¬¬äºŒæ¬¡å¯åŠ¨æ…¢çš„é—®é¢˜
- ğŸ› **ProGuard è§„åˆ™å®Œå–„** - æ·»åŠ  PDFBox å’Œ JP2 ç¼–è§£ç å™¨è­¦å‘ŠæŠ‘åˆ¶

ğŸŒ **ç½‘ç»œä½“éªŒä¼˜åŒ–ï¼š**
- ğŸ“¡ **æ™ºèƒ½é”™è¯¯è¯†åˆ«**ï¼š
  - `failed to connect` â†’ "å¤–ç½‘è®¿é—®ç¹å¿™ï¼Œè¯·ç¨åå†è¯• ğŸŒ"
  - `timeout` â†’ "ç½‘ç»œè¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯• â±ï¸"
  - `Unable to resolve host` â†’ "æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ ğŸ“¡"
- ğŸ’¬ **èŠå¤©ç•Œé¢æ˜¾ç¤ºé”™è¯¯** - è¯†åˆ«å¤±è´¥æ—¶åœ¨å¯¹è¯ä¸­æ˜¾ç¤ºå‹å¥½æç¤º

ğŸ¨ **ç”¨æˆ·ä½“éªŒæ”¹è¿›ï¼š**
- ğŸ” **ç™»å½•æµç¨‹** - å¯åŠ¨åº”ç”¨ â†’ ç™»å½•éªŒè¯ â†’ è¿›å…¥èŠå¤©åˆ—è¡¨
- ğŸ“± **Material 3 è®¾è®¡** - æ¸å˜èƒŒæ™¯ã€åœ†è§’å¡ç‰‡ã€ç°ä»£åŒ–äº¤äº’
- âš ï¸ **é”™è¯¯å¯è§æ€§** - ç½‘ç»œé—®é¢˜ç›´æ¥æ˜¾ç¤ºåœ¨èŠå¤©ç•Œé¢ï¼Œä¸å†é™é»˜å¤±è´¥

---

### v1.8.0 (2025-12-04) ğŸ™ï¸ **é‡å¤§æ›´æ–°**

**æ ¸å¿ƒä¼˜åŒ–ï¼šå®æ—¶è¯­éŸ³å¯¹è¯ç³»ç»Ÿé‡æ„**

ğŸ¯ **æ–°å¢åŠŸèƒ½ï¼š**
- âœ… **å®Œæ•´è¯­éŸ³å¯¹è¯æµç¨‹** - Whisper è¯†åˆ« â†’ AI å›å¤ â†’ TTS è¯­éŸ³åˆæˆ â†’ æ’­æ”¾
- âœ… **è¯­éŸ³æ¶ˆæ¯æ°”æ³¡** - ç±»ä¼¼å¾®ä¿¡çš„è¯­éŸ³æ’­æ”¾å™¨ï¼ˆå¸¦æ³¢å½¢åŠ¨ç”»ï¼‰
- âœ… **"è½¬æ–‡å­—"åŠŸèƒ½** - ç‚¹å‡»å±•å¼€æŸ¥çœ‹è¯­éŸ³å¯¹åº”çš„æ–‡å­—å†…å®¹
- âœ… **å®æ—¶æ¶ˆæ¯æ˜¾ç¤º** - è¯­éŸ³è¯†åˆ«å®Œæˆåç«‹å³æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
- âœ… **åœæ­¢æŒ‰é’®** - AI å›å¤æ—¶æ˜¾ç¤ºçº¢è‰²åœæ­¢æŒ‰é’®ï¼Œå¯éšæ—¶ä¸­æ–­å¯¹è¯
- âœ… **å®æ—¶æ•°æ®åº“ä¿å­˜** - é˜²æ­¢é€€å‡ºæ—¶æ¶ˆæ¯ä¸¢å¤±

ğŸ”§ **å…³é”®ä¿®å¤ï¼š**
- ğŸ› **ä¿®å¤é‡å¤æ¶ˆæ¯** - è§£å†³è¯´ä¸€å¥è¯å‘é€å¤šæ¬¡çš„é—®é¢˜
- ğŸ› **ä¿®å¤å›¾ç‰‡ä¸æ˜¾ç¤º** - è¯­éŸ³æ¶ˆæ¯ç°åœ¨å¯ä»¥æ­£ç¡®æ˜¾ç¤ºå›¾ç‰‡
- ğŸ› **ä¿®å¤æ—¶é•¿æ˜¾ç¤º** - è¯­éŸ³æ—¶é•¿ä»æ¯«ç§’æ”¹ä¸ºç§’ï¼ˆå¦‚ "8''"ï¼‰
- ğŸ› **ä¿®å¤å¹¶å‘å´©æºƒ** - DoubaoRealtimeService æ·»åŠ çº¿ç¨‹å®‰å…¨ä¿æŠ¤
- ğŸ› **ä¿®å¤æ„å›¾æ£€æµ‹é‡å¤** - ä¼˜åŒ– AI æ„å›¾è¯†åˆ«æµç¨‹

âš¡ **æ€§èƒ½ä¼˜åŒ–ï¼š**
- ğŸ“Š **LRU å›¾ç‰‡ç¼“å­˜** - é¿å…é‡å¤è§£ç  Base64 å›¾ç‰‡
- ğŸ”„ **åç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†** - ç»Ÿä¸€ä½¿ç”¨ serviceScopeï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
- ğŸ”’ **çº¿ç¨‹å®‰å…¨** - AudioTrack/AudioRecord è®¿é—®åŠ é”ä¿æŠ¤
- ğŸš€ **æ„å›¾è¯†åˆ«ä¼˜åŒ–** - æœ‰æ–‡ä»¶æ—¶è·³è¿‡æ„å›¾è¯†åˆ«ï¼Œç›´æ¥å¯¹è¯

ğŸ¨ **UI/UX æ”¹è¿›ï¼š**
- ğŸµ **è¯­éŸ³æ³¢å½¢åŠ¨ç”»** - æ’­æ”¾æ—¶åŠ¨æ€æ³¢å½¢æ•ˆæœ
- â±ï¸ **å‡†ç¡®æ—¶é•¿è®¡ç®—** - TTS è¯­éŸ³æ—¶é•¿ = å­—æ•° Ã— 300ms
- ğŸ”´ **åœæ­¢æŒ‰é’®ä¼˜å…ˆçº§** - AI å›å¤æ—¶å§‹ç»ˆæ˜¾ç¤ºåœæ­¢æŒ‰é’®
- ğŸ“± **æ¨¡å¼åˆ‡æ¢ç®€åŒ–** - ç¦ç”¨ç®€å•æ¨¡å¼ï¼Œä¸“æ³¨å®æ—¶å¯¹è¯

ğŸ—„ï¸ **æ•°æ®åº“å‡çº§ï¼š**
- ğŸ”¢ **Version 8** - æ·»åŠ  `imageDescription` å­—æ®µ
- ğŸ›¡ï¸ **å¤šæ¨¡æ€ä¸Šä¸‹æ–‡ç®¡ç†** - é˜²æ­¢ AI æ··æ·†å›¾ç‰‡æ¥æº

ğŸ”’ **èµ„æºç®¡ç†ä¼˜åŒ–ï¼š**
- â±ï¸ **AudioTrack é‡Šæ”¾ä¼˜åŒ–** - æ·»åŠ  flush() å’Œå»¶è¿Ÿï¼Œé˜²æ­¢é‡å¯å¡é¡¿
- ğŸ§¹ **çŠ¶æ€æ£€æŸ¥** - é‡Šæ”¾å‰æ£€æŸ¥ STATE_UNINITIALIZED

ğŸ“ **ä»£ç è´¨é‡ï¼š**
- ğŸ§¹ **ç§»é™¤ç®€å•æ¨¡å¼** - ä»£ç ç®€åŒ–ï¼Œä¸“æ³¨å®æ—¶è¯­éŸ³åŠŸèƒ½
- ğŸ“– **æ—¥å¿—å®Œå–„** - æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—
- ğŸ”§ **é”™è¯¯å¤„ç†** - å®Œå–„å„ç±»å¼‚å¸¸æ•è·

---

### v1.6.0 (2025-11-27)

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… æ–‡æ¡£ä¸Šä¼ åŠŸèƒ½ï¼ˆæ”¯æŒ PDFã€DOCã€TXT ç­‰æ ¼å¼ï¼‰
- âœ… å®æ—¶è¯­éŸ³å¯¹è¯ï¼ˆgpt-4o-mini-realtime-previewï¼‰
- âœ… WebSocket åŒå‘éŸ³é¢‘æµ
- âœ… éº¦å…‹é£æƒé™ç®¡ç†

è¯¦ç»†æ–‡æ¡£ï¼š[NEW_FEATURES_v1.6.0.md](docs/NEW_FEATURES_v1.6.0.md)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¼€å‘æŠ¥å‘Š](å¼€å‘æŠ¥å‘Š-AIè¾…åŠ©å¼€å‘å®è·µä¸äººå·¥ä»·å€¼ä½“ç°.md) - è¯¦ç»†çš„å¼€å‘è¿‡ç¨‹ä¸æŠ€æœ¯å®ç°

---

<div align="center">
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ Star æ”¯æŒä¸€ä¸‹ï¼</p>
  <p>Made with â¤ï¸ by Jetchat Team</p>
</div>
