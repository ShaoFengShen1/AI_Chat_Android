# è´¡çŒ®æŒ‡å—

æ„Ÿè°¢ä½ å¯¹ Jetchat é¡¹ç›®çš„å…³æ³¨ï¼æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ã€‚

---

## ğŸ¤ å¦‚ä½•è´¡çŒ®

### æŠ¥å‘ŠBug

å¦‚æœä½ å‘ç°äº†Bugï¼Œè¯·ï¼š

1. **æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨**ï¼šåœ¨ [Issues](https://github.com/yourusername/Jetchat/issues) ä¸­æœç´¢ç±»ä¼¼é—®é¢˜
2. **åˆ›å»ºIssue**ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ›å»ºæ–°Issueå¹¶åŒ…å«ï¼š
   - æ¸…æ™°çš„æ ‡é¢˜å’Œæè¿°
   - å¤ç°æ­¥éª¤
   - é¢„æœŸè¡Œä¸º vs å®é™…è¡Œä¸º
   - è®¾å¤‡ä¿¡æ¯ï¼ˆAndroidç‰ˆæœ¬ã€è®¾å¤‡å‹å·ï¼‰
   - æ—¥å¿—è¾“å‡ºï¼ˆå¦‚æœæœ‰ï¼‰
   - æˆªå›¾/å½•å±ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

**Bug Reportæ¨¡æ¿ï¼š**

```markdown
**æè¿°Bug**
ç®€æ´æ¸…æ™°åœ°æè¿°Bug

**å¤ç°æ­¥éª¤**
1. æ‰“å¼€åº”ç”¨
2. ç‚¹å‡»'...'
3. è¾“å…¥'...'
4. è§‚å¯Ÿåˆ°é”™è¯¯

**é¢„æœŸè¡Œä¸º**
åº”è¯¥æ˜¾ç¤º...

**å®é™…è¡Œä¸º**
å®é™…æ˜¾ç¤º...

**ç¯å¢ƒ**
- è®¾å¤‡ï¼šå°ç±³11
- Androidç‰ˆæœ¬ï¼š13
- åº”ç”¨ç‰ˆæœ¬ï¼š1.4.0

**æ—¥å¿—**
```
ç²˜è´´ç›¸å…³æ—¥å¿—
```

**æˆªå›¾**
å¦‚æœé€‚ç”¨ï¼Œæ·»åŠ æˆªå›¾
```

### å»ºè®®æ–°åŠŸèƒ½

å¦‚æœä½ æœ‰æ–°åŠŸèƒ½çš„æƒ³æ³•ï¼š

1. **æ£€æŸ¥Roadmap**ï¼šæŸ¥çœ‹ [æœªæ¥è®¡åˆ’](../README.md#æœªæ¥è®¡åˆ’)
2. **åˆ›å»ºFeature Request**ï¼šè¯¦ç»†æè¿°åŠŸèƒ½éœ€æ±‚
3. **è®¨è®ºå¯è¡Œæ€§**ï¼šç­‰å¾…ç»´æŠ¤è€…åé¦ˆ

**Feature Requestæ¨¡æ¿ï¼š**

```markdown
**åŠŸèƒ½æè¿°**
æ¸…æ™°æè¿°ä½ æƒ³è¦çš„åŠŸèƒ½

**ä½¿ç”¨åœºæ™¯**
è¿™ä¸ªåŠŸèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ

**å»ºè®®å®ç°æ–¹å¼**
å¦‚æœæœ‰æƒ³æ³•ï¼Œæè¿°å¦‚ä½•å®ç°

**æ›¿ä»£æ–¹æ¡ˆ**
è€ƒè™‘è¿‡å“ªäº›æ›¿ä»£æ–¹æ¡ˆï¼Ÿ

**è¡¥å……ä¿¡æ¯**
å…¶ä»–ç›¸å…³ä¿¡æ¯
```

### æäº¤ä»£ç 

æˆ‘ä»¬æ¬¢è¿Pull Requestï¼è¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š

1. **Forké¡¹ç›®**
   ```bash
   # åœ¨GitHubä¸Šç‚¹å‡»ForkæŒ‰é’®
   ```

2. **å…‹éš†åˆ°æœ¬åœ°**
   ```bash
   git clone https://github.com/your-username/Jetchat.git
   cd Jetchat
   ```

3. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout develop
   git checkout -b feature/amazing-feature
   ```

4. **å¼€å‘åŠŸèƒ½**
   - éµå¾ª [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
   - ç¼–å†™æµ‹è¯•ç”¨ä¾‹
   - æ›´æ–°æ–‡æ¡£

5. **æäº¤ä»£ç **
   ```bash
   git add .
   git commit -m "feat: add amazing feature"
   ```

6. **æ¨é€åˆ°GitHub**
   ```bash
   git push origin feature/amazing-feature
   ```

7. **åˆ›å»ºPull Request**
   - åœ¨GitHubä¸Šåˆ›å»ºPR
   - å¡«å†™PRæ¨¡æ¿
   - ç­‰å¾…ä»£ç å®¡æŸ¥

---

## ğŸ“ ä»£ç è§„èŒƒ

### Kotliné£æ ¼

éµå¾ª [Kotlinå®˜æ–¹ç¼–ç è§„èŒƒ](https://kotlinlang.org/docs/coding-conventions.html)ï¼š

```kotlin
// âœ… å¥½çš„å‘½å
class ChatViewModel
fun sendMessage()
val messageList: List<ChatMessage>

// âŒ ä¸å¥½çš„å‘½å
class chatVM
fun send()
val list: List<ChatMessage>

// âœ… å¥½çš„æ ¼å¼
fun sendMessage(
    content: String,
    imageBase64: String? = null
) {
    viewModelScope.launch {
        // é€»è¾‘
    }
}

// âŒ ä¸å¥½çš„æ ¼å¼
fun sendMessage(content: String,imageBase64: String?=null){
    viewModelScope.launch{
        //é€»è¾‘
    }
}
```

### é¡¹ç›®çº¦å®š

1. **åŒ…ç»“æ„**
   ```
   com.example.compose.jetchat/
   â”œâ”€â”€ config/      # é…ç½®
   â”œâ”€â”€ data/        # æ•°æ®å±‚
   â”œâ”€â”€ ui/          # UIå±‚
   â””â”€â”€ utils/       # å·¥å…·ç±»
   ```

2. **å‘½åè§„åˆ™**
   - **Activity**: `MainActivity`
   - **Fragment**: `ChatFragment`
   - **ViewModel**: `ChatViewModel`
   - **Composable**: `ChatScreen`ã€`MessageBubble`
   - **Entity**: `ChatMessageEntity`
   - **Dao**: `ChatDao`
   - **å¸¸é‡**: `SUMMARY_INTERVAL`

3. **æ³¨é‡Šè§„èŒƒ**
   ```kotlin
   /**
    * å‘é€èŠå¤©æ¶ˆæ¯
    * 
    * @param content æ¶ˆæ¯å†…å®¹
    * @param imageBase64 å¯é€‰çš„å›¾ç‰‡æ•°æ®ï¼ˆBase64ç¼–ç ï¼‰
    * @throws NetworkException ç½‘ç»œé”™è¯¯
    */
   fun sendMessage(content: String, imageBase64: String? = null)
   
   // å…³é”®ä¸šåŠ¡é€»è¾‘çš„æ³¨é‡Š
   // æ¯10è½®å¯¹è¯è§¦å‘æ‘˜è¦ç”Ÿæˆï¼ˆæƒè¡¡äº†Tokenæ¶ˆè€—å’Œä¸Šä¸‹æ–‡å®Œæ•´æ€§ï¼‰
   if (messages.size >= SUMMARY_INTERVAL) {
       generateSummary()
   }
   ```

4. **Composableè§„èŒƒ**
   ```kotlin
   // âœ… å¥½çš„Composable
   @Composable
   fun MessageBubble(
       message: ChatMessage,
       modifier: Modifier = Modifier  // æ€»æ˜¯æä¾›modifierå‚æ•°
   ) {
       // ä½¿ç”¨rememberé¿å…ä¸å¿…è¦çš„é‡ç»„
       val formattedTime = remember(message.timestamp) {
           formatTimestamp(message.timestamp)
       }
       
       Column(modifier = modifier) {
           Text(message.content)
           Text(formattedTime)
       }
   }
   
   // âŒ ä¸å¥½çš„Composable
   @Composable
   fun MessageBubble(message: ChatMessage) {  // ç¼ºå°‘modifier
       // æ²¡æœ‰ä½¿ç”¨rememberï¼Œæ¯æ¬¡éƒ½é‡æ–°è®¡ç®—
       val time = formatTimestamp(message.timestamp)
       
       Column {
           Text(message.content)
           Text(time)
       }
   }
   ```

---

## ğŸ§ª æµ‹è¯•è¦æ±‚

### å•å…ƒæµ‹è¯•

ä¸ºæ–°åŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•ï¼š

```kotlin
class ConversationSummaryManagerTest {
    private lateinit var manager: ConversationSummaryManager
    private lateinit var mockChatDao: ChatDao
    private lateinit var mockSummaryDao: SessionSummaryDao
    private lateinit var mockApiService: ApiService
    
    @Before
    fun setup() {
        mockChatDao = mockk()
        mockSummaryDao = mockk()
        mockApiService = mockk()
        manager = ConversationSummaryManager(mockChatDao, mockSummaryDao, mockApiService)
    }
    
    @Test
    fun `should generate summary after 10 messages`() = runTest {
        // Arrange
        coEvery { mockChatDao.getMessagesBySessionId(any()) } returns createMessages(10)
        coEvery { mockSummaryDao.getSummary(any()) } returns null
        
        // Act
        val result = manager.shouldGenerateSummary("session-1")
        
        // Assert
        assertTrue(result)
    }
}
```

### UIæµ‹è¯•

ä¸ºUIç»„ä»¶ç¼–å†™æµ‹è¯•ï¼š

```kotlin
class ChatScreenTest {
    @get:Rule
    val composeTestRule = createComposeRule()
    
    @Test
    fun `should display message after sending`() {
        composeTestRule.setContent {
            ChatScreen(sessionId = "test")
        }
        
        // è¾“å…¥æ¶ˆæ¯
        composeTestRule.onNodeWithTag("input").performTextInput("Hello")
        composeTestRule.onNodeWithTag("send").performClick()
        
        // éªŒè¯æ¶ˆæ¯æ˜¾ç¤º
        composeTestRule.onNodeWithText("Hello").assertIsDisplayed()
    }
}
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./gradlew test

# è¿è¡Œç‰¹å®šæµ‹è¯•
./gradlew test --tests ConversationSummaryManagerTest

# è¿è¡ŒUIæµ‹è¯•
./gradlew connectedAndroidTest
```

---

## ğŸ“¦ Commitè§„èŒƒ

éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š

### æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

### Typeç±»å‹

- `feat`: æ–°åŠŸèƒ½
- `fix`: Bugä¿®å¤
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `refactor`: é‡æ„ï¼ˆä¸æ”¹å˜åŠŸèƒ½ï¼‰
- `style`: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“é€»è¾‘ï¼‰
- `test`: æµ‹è¯•ç›¸å…³
- `docs`: æ–‡æ¡£æ›´æ–°
- `chore`: æ„å»º/å·¥å…·é…ç½®

### ç¤ºä¾‹

```bash
# æ–°åŠŸèƒ½
git commit -m "feat(chat): add voice input support"

# Bugä¿®å¤
git commit -m "fix(image): resolve memory leak in ImageCache

- Add entryRemoved callback to recycle bitmaps
- Implement proper lifecycle management
- Add unit tests for cache behavior

Fixes #123"

# æ€§èƒ½ä¼˜åŒ–
git commit -m "perf(database): add indexes to improve query performance

- Add index on sessionId column
- Add composite index on (sessionId, timestamp)
- Query time reduced from 120ms to 8ms"

# é‡æ„
git commit -m "refactor(api): extract intent detection to separate class

- Create IntentDetector interface
- Implement RegexIntentDetector
- Prepare for AI-based intent detection upgrade"
```

---

## ğŸ” ä»£ç å®¡æŸ¥

Pull Requestä¼šç»è¿‡ä»¥ä¸‹å®¡æŸ¥ï¼š

### å®¡æŸ¥æ¸…å•

- [ ] **åŠŸèƒ½å®Œæ•´**ï¼šå®ç°äº†PRæè¿°çš„æ‰€æœ‰åŠŸèƒ½
- [ ] **æµ‹è¯•è¦†ç›–**ï¼šåŒ…å«å•å…ƒæµ‹è¯•å’ŒUIæµ‹è¯•
- [ ] **ä»£ç è´¨é‡**ï¼šéµå¾ªç¼–ç è§„èŒƒï¼Œæ— æ˜æ˜¾åå‘³é“
- [ ] **æ€§èƒ½å½±å“**ï¼šæ²¡æœ‰å¼•å…¥æ€§èƒ½é—®é¢˜
- [ ] **å…¼å®¹æ€§**ï¼šæ”¯æŒAndroid 7.0+
- [ ] **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] **æ— ç ´åæ€§å˜æ›´**ï¼šæˆ–å·²åœ¨PRä¸­æ˜ç¡®è¯´æ˜

### å®¡æŸ¥æµç¨‹

1. **è‡ªåŠ¨æ£€æŸ¥**ï¼šCI/CDè‡ªåŠ¨è¿è¡Œæµ‹è¯•å’Œlint
2. **ä»£ç å®¡æŸ¥**ï¼šè‡³å°‘1åç»´æŠ¤è€…å®¡æŸ¥ä»£ç 
3. **ä¿®æ”¹åé¦ˆ**ï¼šæ ¹æ®å®¡æŸ¥æ„è§ä¿®æ”¹ä»£ç 
4. **æ‰¹å‡†åˆå¹¶**ï¼šå®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ°developåˆ†æ”¯

---

## ğŸ¯ å¼€å‘ç¯å¢ƒè®¾ç½®

### å¿…éœ€å·¥å…·

- Android Studio Hedgehog | 2023.1.1+
- JDK 17
- Android SDK (API 24+)
- Git

### é…ç½®æ­¥éª¤

1. **å®‰è£…Android Studio**
   ```bash
   # ä¸‹è½½åœ°å€ï¼šhttps://developer.android.com/studio
   ```

2. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/yourusername/Jetchat.git
   cd Jetchat
   ```

3. **é…ç½®APIå¯†é’¥**
   ```bash
   # ç¼–è¾‘ app/src/main/java/com/example/compose/jetchat/config/AppConfig.kt
   const val API_KEY = "your-api-key-here"
   ```

4. **åŒæ­¥ä¾èµ–**
   ```bash
   ./gradlew build
   ```

5. **è¿è¡Œåº”ç”¨**
   ```bash
   ./gradlew installDebug
   ```

### æ¨èæ’ä»¶

- **Kotlin Plugin**ï¼šKotlinè¯­è¨€æ”¯æŒ
- **Compose UI**ï¼šComposeé¢„è§ˆå’Œå·¥å…·
- **Database Inspector**ï¼šRoomæ•°æ®åº“è°ƒè¯•
- **Logcat**ï¼šæ—¥å¿—æŸ¥çœ‹

---

## ğŸ“š å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Jetpack Compose](https://developer.android.com/jetpack/compose)
- [Androidæ¶æ„ç»„ä»¶](https://developer.android.com/topic/architecture)
- [Kotlinåç¨‹](https://kotlinlang.org/docs/coroutines-overview.html)
- [Roomæ•°æ®åº“](https://developer.android.com/training/data-storage/room)

### é¡¹ç›®æ–‡æ¡£

- [æ¶æ„è®¾è®¡](ARCHITECTURE.md)
- [é…ç½®æŒ‡å—](CONFIG.md)
- [å¼€å‘æŠ¥å‘Š](../å¼€å‘æŠ¥å‘Š-AIè¾…åŠ©å¼€å‘å®è·µä¸äººå·¥ä»·å€¼ä½“ç°.md)

---

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°çš„AIæ¨¡å‹ï¼Ÿ

A: åœ¨ `AppConfig.kt` ä¸­æ·»åŠ æ¨¡å‹é…ç½®ï¼Œåœ¨ `ApiService.kt` ä¸­æ·»åŠ æ¨¡å‹è·¯ç”±é€»è¾‘ã€‚

### Q: å¦‚ä½•ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“æ€§èƒ½ï¼Ÿ

A: è°ƒæ•´ `MAX_IMAGE_SIZE` å’Œ `IMAGE_QUALITY` å‚æ•°ï¼Œæˆ–å¢åŠ LRUç¼“å­˜å¤§å°ã€‚

### Q: å¦‚ä½•æ·»åŠ æ•°æ®åº“è¿ç§»ï¼Ÿ

A: å‚è€ƒ [é…ç½®æŒ‡å—-æ•°æ®åº“é…ç½®](CONFIG.md#æ•°æ®åº“é…ç½®)ã€‚

### Q: å¦‚ä½•è°ƒè¯•ç½‘ç»œè¯·æ±‚ï¼Ÿ

A: è®¾ç½® `ENABLE_LOGGING = true`ï¼ŒæŸ¥çœ‹Logcatä¸­çš„ `ApiService` æ ‡ç­¾æ—¥å¿—ã€‚

---

## ğŸ“§ è”ç³»æ–¹å¼

- **æIssue**ï¼š[GitHub Issues](https://github.com/yourusername/Jetchat/issues)
- **è®¨è®º**ï¼š[GitHub Discussions](https://github.com/yourusername/Jetchat/discussions)
- **é‚®ä»¶**ï¼šyour-email@example.com

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºJetchatåšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

<div align="center">
  <p>Happy Coding! ğŸš€</p>
</div>
